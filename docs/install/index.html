<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAGE Installation Guide: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="doxylogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">SAGE Installation Guide
   </div>
   <div id="projectbrief">A Simple Academic Game Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="contents">
<div class="textblock"><p><a class="anchor" id="preamble"></a> Before we begin, make sure that you are on a PC running Windows 11 and that your account has the authority to install new programs and to create and edit Windows environment variables. This may not be the case if you are on a work or school computer. If you are unfamiliar with environment variables, you can access them by hitting the Window key on your keyboard and typing "Environment". Click on <code>Edit the system environment variables</code>. The <code>Environment Variables</code> dialog box should appear. Click on the <code>New</code> or <code>Edit</code> button and fill in the name and value fields.</p>
<p><a class="anchor" id="visualstudio"></a></p><h1>1. Microsoft Visual Studio</h1>
<p>If your computer already has Microsoft Visual Studio installed, check that it has the following three workloads as shown in <a class="el" href="index.html#fig1">Fig. 1</a>: Desktop development with C++, Game development with C++, and .NET desktop development. If not, you can install them from within Visual Studio without having to deinstall and reinstall the whole thing. You can get a copy of Visual Studio Community from <a href="https://visualstudio.microsoft.com/vs/community/">https://visualstudio.microsoft.com/vs/community/</a>. Make sure that you choose the workloads mentioned above.</p>
<p><a class="anchor" id="fig1"></a></p><div class="image">
<img src="vsconfig.png" alt="" width="95%"/>
<div class="caption">
Fig 1. Visual Studio Workloads.</div></div>
<p><a class="anchor" id="msbuild"></a></p><h1>2. MSBuild</h1>
<p>In order to use the included batch files <code>Build.bat</code> for fast compilation without running Visual Studio, you must add the location of <code>MSBuild.exe</code>, which was installed when you installed Visual Studio, to your <code>Path</code> environment variable. Its location will depend on which version of Visual Studio you are running. For example, the location for Visual Studio 2022 Community is </p><pre class="fragment">C:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Current\Bin
</pre><p>If you are unfamiliar with the process of modifying or creating an environment variable, begin by hitting the Window key on your keyboard and typing "Environment". Click on <code>Edit the system environment variables</code>. The <code>Environment Variables</code> dialog box should appear. Click on the <code>New</code> or <code>Edit</code> button and fill in the name and value fields.</p>
<p><b>Important Note</b>: Visual Studio only reads the contents of environment variables on startup, so make your you quit all instances of Visual Studio and restart them after creating or changing any environment variable.</p>
<p><a class="anchor" id="directxtk12"></a></p><h1>3. DirectXTK12</h1>
<p>Before compiling SAGE you must install and compile the DirectX12 Toolkit. Clone or download the source code from <a href="https://github.com/Microsoft/DirectXTK12/">https://github.com/Microsoft/DirectXTK12/</a>. Open <code>DirectXTK_Desktop_2022_Win10.sln</code> in Visual Studio and compile in both <code>Release</code> and <code>Debug</code> configurations with 64-bit platform (<code>x64</code>) selected. We use <code>x64</code> because data that is to be uploaded to the GPU needs to be 16-byte aligned, which happens automatically with 64-bit code but not with 32-bit code. Technically it is possible to modify SAGE to work on a 32-bit platform, but that involves overriding the <code>new</code> operator in the renderer and life's just too short to get into that.</p>
<p>Next, create a Windows environment variable <code>DIRECTXTK12_DIR</code> and set it to the name of the folder in which you installed DirectXTK 12. On my computer this is <code>C:\Users\ian\Documents\GitHub\DXTK12\</code>. Then create a Windows environment variable <code>DIRECTXTK12LIB_DIR</code> and set it to the name of the library folder for DirectXTK 12. On my computer this is <code>C:\Users\ian\Documents\GitHub\DXTK12\Bin\Desktop_2019_Win10\</code>. Make sure that both paths ends in a backslash character.</p>
<p><a class="anchor" id="sage"></a></p><h1>4. SAGE</h1>
<p>To check that you have done it right so far, you will find a batch files <code>testenv.bat</code> in the folder with <code>Sage.sln</code>. Double-click on it to run. If all goes well, you will see the message "0 errors found".</p>
<p>Open <code>Sage.sln</code> in Visual Studio and compile in both <code>Release</code> and <code>Debug</code> configurations with 64-bit platform (<code>x64</code>) selected. As part of the build process, this will create a Windows environment variable <code>SAGE_DIR</code> and set it to the current folder. This will be used in all SAGE games to tell Visual Studio where to find SAGE header and library files.</p>
<p>Alternately, running <code>Build.bat</code> will compile in both Release and Debug configurations and set the <code>SAGE_DIR</code> environment variable. Note, however, that it simply reports success or failure for each configuration. There are no warning or error messages. If a build fails, run <code>testenv.bat</code> and try building in Visual Studio instead.</p>
<p><a class="anchor" id="vld"></a></p><h1>5. Visual Leak Detector</h1>
<p>We strongly recommend that you install Visual Leak Detector from <a href="https://kinddragon.github.io/vld/">https://kinddragon.github.io/vld/</a>. Click on <code>Releases</code> and run the latest installer. You will need to set an environment variable <code>VLD_DIR</code> that SAGE will use to find the header and library folders for Visual Leak Detector. The default is <code>C:\Program Files (x86)\Visual Leak Detector</code> (unless you opted to install it in a different location). Visual Leak Detector detects memory leaks but only works when your game is compiled in <code>Debug</code> mode.</p>
<p>Alternately, if you don't want Visual Leak Detector to detect memory leaks, simply comment out the line <code>#include &lt;vld.h&gt;</code> from the file <code>Main.cpp</code> in any SAGE games.</p>
<p><a class="anchor" id="box2d"></a></p><h1>6. Box2D</h1>
<p>Some SAGE physics games require that you install a 2D physics engine called Box2D. First you must install <code>CMake</code> from <a href="https://cmake.org/">https://cmake.org/</a>. Make sure that you click the "Add CMake to the system PATH for the current user" radio button on the <code>CMake</code> Install Options dialog box when it appears. Then clone or download the source code for Box2D from <a href="https://github.com/erincatto/Box2D">https://github.com/erincatto/Box2D</a>. Run <code>Build.bat</code>, which will open <code>Box2D.sln</code> in Visual Studio. Build it in both Debug and Release configurations for the <code>x64</code> platform. Finally, create an environment variable <code>BOX2D_DIR</code> and set it to folder into which you cloned or downloaded Box2D. Mine is set to <code>C:\Users\ian\Documents\GitHub\Box2D\</code>.</p>
<p><a class="anchor" id="bullet"></a></p><h1>7. Bullet Physics</h1>
<p>Some SAGE physics games require that you install a 3D physics engine called Bullet Physics. Clone or download the source code for Bullet Physics from <a href="https://github.com/bullet3/bullet3">https://github.com/bullet3/bullet3</a>. Run <code>build_visual_studio_vr_pybullet_double.bat</code>. This will create <code>0_Bullet3Solution.sln</code>, which is a solution file for an older version of Visual Studio. Open <code>0_Bullet3Solution.sln</code> in Visual Studio. It will ask you to retarget all of the projects in the solution. Click OK.</p>
<p>In the Visual Studio Solution Explorer, select the projects <code>BulletCollision</code>, <code>BulletDynamics</code>, and <code>LinearMath</code>. Right-click on one of them and select Properties. We have to change some settings to make it compatible with the rest of our code before we build it. Firstly we need to change the precision from <code>double</code> to <code>float</code>. In the Property pages (see <a class="el" href="index.html#fig2">Fig. 2</a>) for <code>All Configurations</code> of the platform <code>x64</code> select <code>C/C++</code> then <code>Preprocessor</code> in the left pane and <code>Preprocessor Definitions</code> in the right pane. Delete the string <code>BT_USE_DOUBLE_PRECISION;</code> and click OK. This is shown in <a class="el" href="index.html#fig2">Fig. 2</a>.</p>
<p><a class="anchor" id="fig2"></a></p><div class="image">
<img src="bulletfloat.png" alt="" width="60%"/>
<div class="caption">
Fig 2. Bullet preprocessor definitions.</div></div>
<p>Secondly, we need to change the run-time library to <code>Multi-threaded DLL</code>. This is done as follows. On the same page as above, select the Release configuration of the platform <code>x64</code>. Next, select <code>C/C++</code> then <code>Code Generation</code> in the left pane and <code>Runtime Library</code> in the right pane. Select <code>Multi-threaded DLL (/MD)</code> from the drop-down menu beside it. This is shown in <a class="el" href="index.html#fig3">Fig. 3</a>. Do the same for the Debug configuration of the platform <code>x64</code>, but in this case select <code>Multi-threaded Debug DLL (/MDd)</code> from the drop-down menu.</p>
<p><a class="anchor" id="fig3"></a></p><div class="image">
<img src="bulletmtr.png" alt="" width="60%"/>
<div class="caption">
Fig 3. Bullet runtime library.</div></div>
<p>Build the three projects mentioned above in both Debug and Release configurations for the <code>x64</code> platform. Finally, create an environment variable <code>BULLET_DIR</code> and set it to folder into which you cloned or downloaded Bullet Physics. Mine is set to <code>C:\Users\ian\Documents\GitHub\bullet3\</code>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
