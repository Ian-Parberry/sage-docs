<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Top-Down Game Prototype: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">The Top-Down Game Prototype
   </div>
   <div id="projectbrief">A Basic Top-Down Shooter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="contents">
<div class="textblock"><p><a class="anchor" id="sec1"></a></p><h1>1. Introduction</h1>
<p>This is a simple top-down game with graphics, particle effects, and sound. The player character is a person in a brown cap with a rifle shown at bottom left in <a class="el" href="index.html#fig1">Fig. 1</a>. There is a non-player character in a green cap standing guard in a bunker at the top right of <a class="el" href="index.html#fig1">Fig. 1</a>. The guard will shoot at you if you are too close or if you draw attention to yourself by firing your gun. You control your character with either the the keyboard and mouse, or with an XBox controller (see <a class="el" href="index.html#sec2">Section 2</a>). The controller takes precedence over the keyboard and mouse when it is plugged in.</p>
<p>The background is a simple image and the world size is its width and height, which are larger than the window. The camera follows the player but it stops at the edges of the world so that you never see anything that is outside the world. Bullets persist until they run into something, either the player, the guard, or the edges of the world, at which time a particle engine is used to mark the point of impact (a blood spatter or a small cloud of dust). The guard rotates but does not move from the bunker.</p>
<p><a class="anchor" id="fig1"></a></p><div class="image">
<img src="screenshot.png" alt="" width="50%"/>
<div class="caption">
Fig. 1: A screenshot of the Top-Down Game.</div></div>
<p>The remainder of this page is divided into four sections. <a class="el" href="index.html#sec2">Section 2</a> lists the controls and their corresponding actions, <a class="el" href="index.html#sec3">Section 3</a> tells you how to build it, <a class="el" href="index.html#sec4">Section 4</a> gives a breakdown of the code, and <a class="el" href="index.html#sec5">Section 5</a> addresses the question "what next?".</p>
<p><a class="anchor" id="sec2"></a></p><h1>2. Controls</h1>
<center> <table class="doxtable">
<tr>
<td><center><b>Keyboard</b></center> </td><td><center><b>Controller</b></center> </td><td><center><b>Mouse</b></center> </td><td><center><b>Action</b></center> </td></tr>
<tr>
<td><center>F1</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Help (this document) </td></tr>
<tr>
<td><center>F2</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Toggle frame rate display </td></tr>
<tr>
<td><center>F3</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Toggle show bounds </td></tr>
<tr>
<td><center>F4</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Toggle show NPC state </td></tr>
<tr>
<td><center>-</center> </td><td>Right thumb </td><td>Move left* </td><td>Rotate counterclockwise </td></tr>
<tr>
<td><center>-</center> </td><td>Right thumb </td><td>Move right* </td><td>Rotate clockwise </td></tr>
<tr>
<td><center>Space</center> </td><td>Right button </td><td>Left button </td><td>Shoot </td></tr>
<tr>
<td><center>A</center> </td><td>Digital pad left </td><td><center>-</center> </td><td>Strafe left </td></tr>
<tr>
<td><center>D</center> </td><td>Digital pad right </td><td><center>-</center> </td><td>Strafe right </td></tr>
<tr>
<td><center>G</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Toggle God mode </td></tr>
<tr>
<td><center>S</center> </td><td>Digital pad down </td><td><center>-</center> </td><td>Retreat </td></tr>
<tr>
<td><center>W</center> </td><td>Right trigger </td><td><center>-</center> </td><td>Move forwards </td></tr>
<tr>
<td><center>Backspace</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Restart game </td></tr>
<tr>
<td><center>PrtScr</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Save screenshot to a PNG file </td></tr>
<tr>
<td><center>Esc</center> </td><td><center>-</center> </td><td><center>-</center> </td><td>Exit </td></tr>
</table>
</center><p><code>*</code> Note that the mouse cursor must be inside the game window for player rotation to occur.</p>
<p><a class="anchor" id="sec3"></a></p><h1>3. How to Build</h1>
<p>This code uses <a href="../sage/index.html">SAGE</a>. Make sure that you have followed the <a href="../install/index.html">SAGE Installation Instructions</a>. Navigate to the folder <code>1. Top Down Game</code> in your copy of the <code>sage-games</code> repository. Run <code>checkenv.bat</code> to verify that you have set the environment variables correctly. Open <code>Top Down Game.sln</code> with Visual Studio and build the Release configuration. The Release executable file <code>Top Down Game.exe</code> will appear. Alternatively, run <code>Build.bat</code> to build both Release and Debug configurations.</p>
<p><a class="anchor" id="sec4"></a></p><h1>4. Code Breakdown</h1>
<p>Open <code>Top Down Game.sln</code> in Visual Studio and examine the code in the editor while you read the rest of this section. This section assumes that you have read and understood the documentation from <a href="../sage/index.html">SAGE</a> and <a href="../blank">The Blank Game</a>.</p>
<p><a class="anchor" id="sec4-2"></a></p><h2>4.1 Particle Engines</h2>
<p><a class="anchor" id="sec4-2"></a></p><h2>4.2 Game Objects</h2>
<p><a class="anchor" id="sec4-2-1"></a></p><h3>4.2.1 Base Game Object</h3>
<p>The base game object <code><a class="el" href="class_c_object.html" title="The game object.">CObject</a></code> is declared in <code><a class="el" href="_object_8h.html" title="Interface for the game object class CObject.">Object.h</a></code> and defined in <code><a class="el" href="_object_8cpp.html" title="Code for the game object class CObject.">Object.cpp</a></code>. It is derived from <a href="../sage/class_sage_1_1_c_object.html"><code>Sage::CObject</code></a>.</p>
<p><a class="anchor" id="sec4-2-2"></a></p><h3>4.2.2 Armed Object</h3>
<p>The armed object <code><a class="el" href="class_c_armed_object.html" title="The armed object.">CArmedObject</a></code> is declared in <code><a class="el" href="_armed_object_8h.html" title="Interface for the armed game object class CArmedObject.">ArmedObject.h</a></code> and defined in <code><a class="el" href="_armed_object_8cpp.html" title="Code for the game object class CArmedObject.">ArmedObject.cpp</a></code>. It is derived from <code><a class="el" href="class_c_object.html" title="The game object.">CObject</a></code> (see <a class="el" href="index.html#sec4-2-1">Section 4.2.1</a>). Recall that the <a href="../sage/class_sage_1_1_c_sprite_renderer.html#ac3515ab913c5849c73bbf52532b3ca30"><code>Sage::CSpriteRenderer::Draw()</code></a> function draws sprites with their center at the position specified by a parameter and optionally rotates the sprite about its center by another parameter. We saw this in action when drawing the text ring at the center of the window in the and <a href="../blank">The Blank Game</a>. In this game the armed objects are the player and the guard, seen in <a class="el" href="index.html#fig2">Fig. 2</a>.</p>
<p><a class="anchor" id="fig2"></a></p><div class="image">
<img src="PCandNPC.png" alt="" width="35%"/>
<div class="caption">
Fig. 2: The player (left) and guard (right) sprites.</div></div>
<p>These sprites will be drawn by <code><a class="el" href="class_c_armed_object.html#aad111986969a998621a865da7e0e562d" title="Draw object.">CArmedObject::Draw()</a></code> with the center of sprite's cap at the object's position and they should rotate about that point. In order to do this we need the vector offset from the center of the object to the center of the sprite, called the <em>center offset</em> (see <a class="el" href="index.html#fig3">Figure 3</a>). This will be stored in protected member variable <code><a class="el" href="class_c_armed_object.html#a83b57ecaefa829ef5442fcfbaee8830d" title="Sprite center offset.">CArmedObject::m_vCenterOffset</a></code>. We will also animate a muzzle flash particle effect at the end of the gun barrel. To do this we need the vector offset from the center of the sprite to the end of the gun barrel, called the <em>gun offset</em> (see also <a class="el" href="index.html#fig3">Figure 3</a>). This will be stored in protected member variable <code><a class="el" href="class_c_armed_object.html#a86b429611b2cbdf0ec856ddee7fd79f4" title="Sprite gun offset.">CArmedObject::m_vGunOffset</a></code>.</p>
<p><a class="anchor" id="fig3"></a></p><div class="image">
<img src="offsets.png" alt="" width="35%"/>
<div class="caption">
Fig. 3: The player sprite and offsets.</div></div>
<p><code><a class="el" href="class_c_armed_object.html" title="The armed object.">CArmedObject</a></code> contains a private pointer <code>m_pLocalParticleEngine</code> to a <a href="../sage/index.html#sec3-8">2D particle engine</a> for particle effects that move with that object. In particular we need to draw the muzzle flash (which is animated over several frames) at the end of the gun barrel, which may have moved and/or rotated from its position when the gun fired. In order to do this we will need to call <a href="../sage/class_sage_1_1_c_particle_engine.html#a5e4add4fdc2f94979d70ea3b1f10053b">Sage::CSpriteEngine2D::TranslateTo()</a> to the translated and rotated muzzle position along with <a href="../sage/class_sage_1_1_c_particle_engine.html#aebc9640270acf9d83595238d533c073f">Sage::CSpriteEngine2D::Step()</a> once per frame in <code><a class="el" href="class_c_armed_object.html#a3f6fe2f4bcdfefc75a7724343aadf5c2" title="Move object.">CArmedObject::Move()</a></code>.</p>
<p>Another <code><a class="el" href="class_c_armed_object.html" title="The armed object.">CArmedObject</a></code> member function of interest is <code><a class="el" href="class_c_armed_object.html#ae851dd350dbe22f775100a4f7815d959" title="Swivel towards position.">CArmedObject::RotateTowards()</a></code>, which takes as parameter a 2D vector called the <em>target</em> and rotates the sprite so that the gun barrel is closer to pointing at the target, returning <code>true</code> if it is pointing "close enough" to it. See the full description of <code><a class="el" href="class_c_armed_object.html#ae851dd350dbe22f775100a4f7815d959" title="Swivel towards position.">CArmedObject::RotateTowards()</a></code> for more details on how this is done. <code><a class="el" href="class_c_armed_object.html#ae851dd350dbe22f775100a4f7815d959" title="Swivel towards position.">CArmedObject::RotateTowards()</a></code> will be used to smoothly rotate the player to face the mouse pointer (see <a class="el" href="index.html#sec4-2-3">Section 4.2.3</a>) and for the guard to smoothly rotate to face the player under control of its AI (see <a class="el" href="index.html#sec4-2-4">Section 4.2.4</a>).</p>
<p><a class="anchor" id="sec4-2-3"></a></p><h3>4.2.3 Player Object</h3>
<p>The player object <code><a class="el" href="class_c_player.html" title="The player object.">CPlayer</a></code> is declared in <code><a class="el" href="_player_8h.html" title="Interface for the player object class CPlayer.">Player.h</a></code> and defined in <code><a class="el" href="_player_8cpp.html" title="Code for the player object class CPlayer.">Player.cpp</a></code>. It is derived from <code><a class="el" href="class_c_armed_object.html" title="The armed object.">CArmedObject</a></code> (see <a class="el" href="index.html#sec4-2-2">Section 4.2.2</a>).</p>
<p><a class="anchor" id="sec4-2-4"></a></p><h3>4.2.4 Guard Object</h3>
<p>The guard object <code><a class="el" href="class_c_guard.html" title="The guard object.">CGuard</a></code> is declared in <code><a class="el" href="_guard_8h.html" title="Interface for the guard object class CGuard.">Guard.h</a></code> and defined in <code><a class="el" href="_guard_8cpp.html" title="Code for the guard object class CGuard.">Guard.cpp</a></code>. It is derived from <code><a class="el" href="class_c_armed_object.html" title="The armed object.">CArmedObject</a></code> (see <a class="el" href="index.html#sec4-2-2">Section 4.2.2</a>).</p>
<p><a class="anchor" id="fig3"></a></p><div class="image">
<img src="reload.gif" alt=""/>
<div class="caption">
Fig. 3: The guard shotgun reload animation.</div></div>
<p><a class="anchor" id="sec4-2-5"></a></p><h3>4.2.5 Bullet Object</h3>
<p>The bullet object <code><a class="el" href="class_c_bullet.html" title="The bullet object.">CBullet</a></code> is declared in <code><a class="el" href="_bullet_8h.html" title="Interface for the bullet object class CBullet.">Bullet.h</a></code> and defined in <code><a class="el" href="_bullet_8cpp.html" title="Code for the bullet object class CBullet.">Bullet.cpp</a></code>. It is derived from <code><a class="el" href="class_c_object.html" title="The game object.">CObject</a></code> (see <a class="el" href="index.html#sec4-2-1">Section 4.2.1</a>).</p>
<p><code><a class="el" href="class_c_common.html" title="The common variables class.">CCommon</a></code> contains a pointer <code>m_pParticleEngine</code> to a <a href="../sage/index.html#sec3-8">2D particle engine</a> to be used for static particle effects, that is, particle effects that do not move with a particular object.</p>
<p><a class="anchor" id="sec5"></a></p><h1>5. What Next?</h1>
<p>Next, take a look at the <a href="../topdowntiled">Top Down Tiled Game</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
