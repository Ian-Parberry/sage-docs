<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kissing Numbers: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="sagedoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sage-physics.png"/></td>
  <td id="projectalign">
   <div id="projectname">Kissing Numbers
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="contents">
<div class="textblock"><p><a class="anchor" id="section1"></a></p><h1>1. Introduction</h1>
<p>Suppose we surround our game objects by bounding circles (the circle of smallest radius that surrounds the object's sprite) in 2D and bounding spheres (the smallest sphere that surrounds the vertices in the object's mesh) in 3D. It has been shown that every configuration of \(n\) non-overlapping circles and every configuration of \(n\) non-overlapping spheres can have at most \(O(n)\) contact points. This implies that broad-phase collision detection and response need only process \(O(n)\) collisions per animation frame. This is shown in the next two sections by the use of a concept called the <em>kissing number</em>. Section <a class="el" href="index.html#section2">Section 2</a> proves bounds on 2D kissing numbers, and Section <a class="el" href="index.html#section3">Section 3</a> proves bounds on 3D kissing numbers.</p>
<p><a class="anchor" id="section2"></a></p><h1>2. 2D Kissing Numbers</h1>
<p>This section is divided into two subsections. As a starting point, <a class="el" href="index.html#section2-1">Section 2.1</a> considers the possible number of contacts between \(n\) circles of the same radius. <a class="el" href="index.html#section2-2">Section 2.2</a> extends this result to \(n\) circles that may have different radii.</p>
<p><a class="anchor" id="section2-1"></a></p><h2>2.1 Congruent Circles</h2>
<p><a class="anchor" id="fig2-1"></a></p><div class="image">
<img src="triangle.png" alt="" width="20%"/>
<div class="caption">
Fig. 2.1. Three touching unit circles.</div></div>
<p>Consider contacts between circles of equal radius (called <em>congruent</em> circles). Since the centers of three touching circles form an equilateral triangle whose internal angles are all \(60^{\circ}\) (see <a class="el" href="index.html#fig2-1">Fig. 2.1</a>), each circle can contact at most \(360^{\circ}/60^{\circ} = 6\) others (see <a class="el" href="index.html#fig2-2">Fig. 2.2</a>). This is called the <em>2D congruent kissing number</em> \(k_2 = 6\). Therefore between \(n\) congruent circles there can be at most \(3n\) contacts.</p>
<p><a class="anchor" id="fig2-2"></a></p><div class="image">
<img src="hex.png" alt="" width="30%"/>
<div class="caption">
Fig. 2.2. The yellow circle is touching six green circles.</div></div>
<p><a class="anchor" id="section2-2"></a></p><h2>2.2 Non-Congruent Circles</h2>
<p>The 2D non-congruent kissing number \(\kappa_2\) is also 6. Suppose that we have \(n\) circles of possibly different radii that have \(m\) contact points. Notice that \(k_2 \leq \kappa_2 \leq 2m/n\). Create a graph on \(n\) vertices by placing a vertex at the center of each circle and connecting each pair of vertices with an edge when the corresponding pair of circles are touching (<a class="el" href="index.html#fig2-3">Fig. 2.3</a>). Each edge is completely contained within the two contacting circles and it crosses the circle boundaries at the contact point (<a class="el" href="index.html#fig2-3">Fig. 2.3</a>, center). This graph is therefore planar and has \(m\) edges. A <em>face</em> in a planar graph is an area bounded by edges. The outside of the graph also counts as a face. <a class="el" href="index.html#fig2-3">Fig. 2.3</a> (left) shows 8 noncongruent circles with 11 contact points. <a class="el" href="index.html#fig2-3">Fig. 2.3</a> (right) shows the corresponding planar graph, which has 8 vertices, 11 edges, and 5 faces.</p>
<p><a class="anchor" id="fig2-3"></a></p><div class="image">
<img src="graph.png" alt="" width="60%"/>
<div class="caption">
Fig. 2.3. Constructing a planar graph from non-congruent circles.</div></div>
<p>Euler showed that for planar graphs the number of vertices \(n\) plus the number of faces \(f\) minus the number of edges \(m\) is always equal to 2. That is, \(n-m+f=2\), known as the <em>Euler characteristic</em> of a planar graph. Since every face has at least 3 edges and every edge is in at most 2 faces, \(f \leq 2m/3\). Therefore, by the Euler characteristic, \(n-m/3 \geq 2\), that is, \(m \leq 3n - 6\). Hence, \(\kappa_2 = 2m/n \leq 6\). Since \(\kappa_2 \geq k_2\) and \(k_2 = 6\) (see <a class="el" href="index.html#section2-1">Section 2.1</a>), we can conclude that \(\kappa_2 \geq  6\), completing the proof that \(\kappa_2 = 6\). Therefore between \(n\) non-congruent circles there can be at most \(3n\) contacts.</p>
<p><a class="anchor" id="section3"></a></p><h1>3. 3D Kissing Numbers</h1>
<p>This section is divided into two subsections. As a starting point, <a class="el" href="index.html#section3-1">Section 3.1</a> considers the possible number of contacts between \(n\) spheres of the same radius. <a class="el" href="index.html#section3-2">Section 3.2</a> extends this result to \(n\) spheres that may have different radii.</p>
<p><a class="anchor" id="section3-1"></a></p><h2>3.1 Congruent Spheres</h2>
<p><a class="anchor" id="fig3-1"></a></p><div class="image">
<img src="icosahedron0.png" alt="" width="35%"/>
<div class="caption">
Fig. 3.1. Twelve congruent spheres touching a center sphere (yellow) in three layers.</div></div>
<p>In 3D we can start with a single sphere surrounded by 6 spheres all in a plane, then stack 3 spheres on top and three spheres below in 3 layers as shown in <a class="el" href="index.html#fig3-1">Fig. 3.1</a>. This gives us a 3D kissing number of 12. Or so it seems. It turns out that the spheres don't fit together as tightly in 3D as they did in 2D. Suppose we remove the yellow sphere at the center in <a class="el" href="index.html#fig3-1">Fig. 3.1</a>. If we join the centers of the outside spheres we get an <em>icosahedron</em>, an example of which is shown in <a class="el" href="index.html#fig3-2">Fig. 3.2</a>, left. An icosahedron is made up of 20 equilateral triangles as shown in <a class="el" href="index.html#fig3-2">Fig. 3.2</a>, right.</p>
<p><a class="anchor" id="fig3-2"></a></p><div class="image">
<img src="icosahedron2.png" alt="" width="55%"/>
<div class="caption">
Fig. 3.2. An icosahedron (left) and its triangulation (right).</div></div>
<p>Let's take the smallest icosahedron that we can make out of 12 unit spheres, that is, one whose edge length is 2. (since then we can fit a unit-radius sphere centered at each end of the edge without them overlapping). Let \(\vec{c}\) be the center of the icosahedron, that is, the point that is equidistant from all vertices. The <em>radius</em> of the icosahedron is the distance from \(\vec{c}\) to any vertex \(\vec{p}\) as show in <a class="el" href="index.html#fig3-3">Fig. 3.3</a> (left). Examining <a class="el" href="index.html#fig3-3">Fig. 3.3</a> more closely, we see that \(\vec{c}\) is equidistant from a pair of regular pentagons of side 2 in the horizontal plane. These pentagons are distance \(\sqrt{3}\) apart. To see this, note that the front face of the icosahedron is an equilateral triangle of side 2 in the vertical plane. Therefore, if we draw a vertical line from the lower vertex of that triangle to a point midway along its base as shown in <a class="el" href="index.html#fig3-3">Fig. 3.3</a> (right) then, by the Theorem of Pythagoras, the height of the front triangle \(h\) satisfies \(h^2 + 1 = 2^2\), that is \(h = \sqrt{3}\).</p>
<p><a class="anchor" id="fig3-3"></a></p><div class="image">
<img src="icosahedron1.png" alt="" width="55%"/>
<div class="caption">
Fig. 3.3. Finding the distance between two pentagons in an icosahedron.</div></div>
<p>The center \(\vec{c}\) of the icosahedron aligns vertically with the centers of the two pentagons, as shown in <a class="el" href="index.html#fig3-4">Fig. 3.4.</a> (left). The center of a pentagon divides it into 5 sectors, each of which has two edges of length equal to its radius, the third edge is of course of length 2, and the angle between the two radiuses is \(2 \pi/5\), as shown in <a class="el" href="index.html#fig3-4">Fig. 3.4.</a> (center). The radius \(r_0\) of a regular pentagon of side 2 is therefore given by \(\sin \pi/5 = 1/r_0\) (<a class="el" href="index.html#fig3-4">Fig. 3.4.</a>, right). Therefore,  </p><p class="formulaDsp">
\[
r_0 = \frac{1}{\sin \pi/5} \approx 1.7.
\]
</p>
<p><a class="anchor" id="fig3-4"></a></p><div class="image">
<img src="icosahedron3.png" alt="" width="75%"/>
<div class="caption">
Fig. 3.4. Finding the radius of a pentagon within an icosahedron.</div></div>
<p>The radius \(r\) of an icosahedron of side 2 is the length of the hypotenuse of a right triangle with sides \(r_0\) and \(\sqrt{3}/2\) (see <a class="el" href="index.html#fig3-5">Fig. 3.5</a>). By the Theorem of Pythagoras,  </p><p class="formulaDsp">
\[
r = \sqrt{r_0^2 + 3/4} \approx 1.91.
\]
</p>
<p> Therefore the center sphere can have radius at most \(0.91\). In order to fit in a center sphere of unit radius we have to loosen up the enclosing icosahedron slightly, which means that we can move the outside 12 spheres around while still touching the center one.</p>
<p><a class="anchor" id="fig3-5"></a></p><div class="image">
<img src="icosahedron4.png" alt="" width="45%"/>
<div class="caption">
Fig. 3.5. Finding the radius of an icosahedron.</div></div>
<p>Mathematician David Gregory (1659&ndash;1708) thought he could use that slop to fit in a 13th sphere. Sir Isaac Newton disagreed. Naturally Newton was right and Gregory was wrong, but we had to wait a couple of centuries until Schütte, van der Waerden, and and Leech were able to prove that the 3D congruent kissing number \(k_3 = 12\).</p>
<blockquote class="doxtable">
<p>&zwj;Schütte, K. and van der Waerden, B. L., Das Problem der dreizehn Kugeln, Math. Ann. 125 (1953), 325–334. </p>
</blockquote>
<p><a class="anchor" id="section3-2"></a></p><h2>3.2 Non-Congruent Spheres</h2>
<p>Suppose we have \(n\) non-congruent spheres numbered \(S_0, S_1, \ldots, S_{n-1}\) such that their radii are in nondecreasng order, that is, \(S_i\) has radius \(r_i\) and \(r_0 \leq r_1 \leq \cdots \leq r_{n-1}\). Let's try to count the total number of contacts \(m\). For \(0 \leq i &lt; n\), let \(m_i\) be the number of spheres \(S_j\) that are touching \(S_i\) and are either (a) smaller than \(S_j\), or (b) the same size as \(S_j\) and \(i &lt; j\). Then,  </p><p class="formulaDsp">
\[
m = \sum_{i=0}^{n-1}m_i,
\]
</p>
<p> noting that each contact is counted once because (b) breaks the tie between congruent spheres.</p>
<p><a class="anchor" id="fig3-6"></a></p><div class="image">
<img src="3dnoncongruent-clr.png" alt="" width="65%"/>
<div class="caption">
Fig. 3.6. Replace non-congruent spheres (left) with congruent spheres (right) after removing smaller spheres (center).</div></div>
<p>Consider an individual sphere \(S_i\). For example, <a class="el" href="index.html#fig3-6">Fig. 3.6</a> (left) shows a sphere \(S_i\) with \(m_i = 6\) since \(S_i\) touches 6 spheres, 2 of which are larger, 3 of which are smaller, and one of which is congruent. Disregard the smaller spheres, as shown in <a class="el" href="index.html#fig3-6">Fig. 3.6</a> (center). Replace each of the larger spheres with congruent spheres that have the same respective contact points. Note that \(m_i\) is unchanged through all of these steps. For example, \(m_i = 3\) in all three of the configurations shown in <a class="el" href="index.html#fig3-6">Fig. 3.6</a>. \(S_i\) is now surrounded by \(m_i\) congruent spheres. Therefore, \(m_i \leq k_3\), which means that  </p><p class="formulaDsp">
\[
m = \sum_{i=0}^{n-1}m_i \leq \sum_{i=0}^{n-1} k_3 = nk_3.
\]
</p>
<p> Hence the total number of contacts \(m \leq 12n\) and the average kissing number \(\kappa_3 = 2m/n \leq 2k_3 = 24\). The above proof is from a paper by Kuperberg and Schramm:</p>
<blockquote class="doxtable">
<p>&zwj;Greg Kuperberg and Oded Schramm, "Average kissing numbers for non-congruent sphere packings", <em>Mathematical Research Letters</em>, pp. 339-344. </p>
</blockquote>
<p>They then go on to show using a stronger argument that \(\kappa_3 &lt; 4(2+\sqrt{3}) \approx 14.928\) and \(\kappa_3 \geq 666/53 \approx 12.566\) The best upper bound for \(\kappa_3\) known to the author at present is \(\kappa_3 \leq 13.955\) by Glazyrin:</p>
<blockquote class="doxtable">
<p>&zwj;Alexey Glazyrin, "Contact graphs of ball packings", arXiv preprint arXiv:1707.02526. </p>
</blockquote>
<p>The best lower bound for \(\kappa_3\) known to the author at present is \(\kappa_3 \geq 7656/607 \approx 12.613\) by Eppstein, Kuperberg, and Ziegler:</p>
<blockquote class="doxtable">
<p>&zwj;David Eppstein, Greg Kuperberg, and Günter M Ziegler, "Fat 4-polytopes and fatter 3-spheres." <em>Pure and Applied Mathematics</em>, 253 (2003), 239-266. </p>
</blockquote>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
